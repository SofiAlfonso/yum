<!-- Autor: Jhon Freddy Alzate -->

{% extends "core/base_admin.html" %}
{% load i18n %}

{% block content %}
<div class="container mt-4">
  <h2>{% trans "GestiÃ³n de Tipos de Ingredientes" %}</h2>

  <!-- Filtros -->
  <form method="get" class="row mb-3">
    <div class="col-md-3">
      <label for="name">{% trans "Nombre" %}</label>
      <input type="text" name="name" class="form-control" value="{{ request.GET.name }}">
    </div>
    <div class="col-md-3">
      <label for="category">{% trans "CategorÃ­a" %}</label>
      <select name="category" class="form-control">
        <option value="">{% trans "-- Todas --" %}</option>
        {% for key, value in categories.items %}
          <option value="{{ key }}" {% if request.GET.category == key %}selected{% endif %}>
            {{ value }}
          </option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-3">
      <label for="user">{% trans "Usuario" %}</label>
      <input type="text" name="user" class="form-control" value="{{ request.GET.user }}">
    </div>
    <div class="col-12 mt-2">
      <button type="submit" class="btn btn-brand">Filtrar</button>
      <a href="{% url 'admin_ingredienttype_list' %}" class="btn btn-secondary">{% trans "Limpiar" %}</a>
    </div>
  </form>

  <!-- Tabla -->
  <table class="table table-bordered table-hover">
    <thead>
      <tr>
        <th>{% trans "Nombre" %}</th>
        <th>{% trans "CategorÃ­a" %}</th>
        <th>{% trans "Usuario" %}</th>
        <th>{% trans "Vitaminas" %}</th>
        <th>{% trans "Excesos" %}</th>
        <th>{% trans "Acciones" %}</th>
      </tr>
    </thead>
    <tbody>
      {% for ingredient_type in ingredient_types %}
      <tr>
        <td>{{ ingredient_type.nombre }}</td>
        <td>{{ ingredient_type.get_category_display }}</td>
        <td>{{ ingredient_type.user.username }}</td>
        <td>
          {% if ingredient_type.vitamins %}
            {{ ingredient_type.vitamins|join:", " }}
          {% else %}
            -
          {% endif %}
        </td>
        <td>
          {% if ingredient_type.excesses %}
            {{ ingredient_type.excesses|join:", " }}
          {% else %}
            -
          {% endif %}
        </td>
        <td>
          <a href="{% url 'admin_ingredienttype_detail' ingredient_type.pk %}" class="btn btn-sm btn-info">ğŸ‘ Ver</a>
          <a href="{% url 'admin_ingredienttype_edit' ingredient_type.pk %}" class="btn btn-sm btn-warning">âœï¸ Editar</a>
          <a href="{% url 'admin_ingredienttype_delete' ingredient_type.pk %}" class="btn btn-sm btn-danger">ğŸ—‘ Eliminar</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="6">{% trans "No hay tipos de ingredientes registrados." %}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- PaginaciÃ³n -->
  <div class="pagination">
    {% if is_paginated %}
      {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}" class="btn btn-sm btn-secondary">{% trans "Anterior" %}</a>
      {% endif %}

      <span>PÃ¡gina {{ page_obj.number }}{% trans "de" %}{{ page_obj.paginator.num_pages }}</span>

      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}" class="btn btn-sm btn-secondary">{% trans "Siguiente" %}</a>
      {% endif %}
    {% endif %}
  </div>
</div>
{% endblock %}
